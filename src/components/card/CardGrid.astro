---
import CardGridItem from "./CardGridItem.astro";
import ErrorMessage from "../ErrorMessage.astro";
import type { PokeCardMini } from "../../models/PokeCardMini";
import ListCardForm from "../list/ListCardForm.astro";

interface Props {
  cards: PokeCardMini[] | null;
  error: string | null;
  setId: string | null;
  lang: string;
  title: string | null;
}

const { setId, cards, error, lang, title } = Astro.props;
---

<div id="cards-div" style="position: relative;">
  <div class="cards-grid-header container">
    <div>
      <span> {cards?.length} Cards</span>
    </div>
    <span>{title || ""}</span>
    <div>Buscar por:</div>
  </div>

  <ErrorMessage error={error} />

  <div class="cards-grid container">
    {
      cards && cards?.length > 0 ? (
        cards.map((item) => <CardGridItem card={item} lang={lang} />)
      ) : (
        <div class="no-cards" style="grid-column: 1 / -1; text-align: center;">
          <h2>No cards found</h2>
          <p>Please select a different set.</p>
        </div>
      )
    }
  </div>

  <ListCardForm />

  <script defer src="/scripts/cardItemEffect.js"></script>

  <!-- <script is:inline>
    const cards = document.querySelectorAll(".cardItemEffect");
    console.log(cards);

    cards.forEach((card) => {
      card.addEventListener("mousemove", (evt) => {
        mouseHoverCard(card, evt);
      });
      card.addEventListener("mouseleave", () => {
        mouseLeaveCard(card);
      });
    });

    function mouseHoverCard(card, evt) {
      const height = card.clientHeight;
      const width = card.clientWidth;

      const { layerX, layerY } = evt;

      const yRotation = ((layerX - width / 2) / width) * -20;
      const xRotation = ((layerY - height / 2) / height) * 20;

      const string = `perspective(500px) rotateX(${xRotation}deg) rotateY(${yRotation}deg) scale(1.05)`;

      card.style.transform = string;
    }

    function mouseLeaveCard(card) {
      card.style.transform =
        "perspective(500px) rotateX(0deg) rotateY(0deg) scale(1)";
    }
  </script> -->
</div>
