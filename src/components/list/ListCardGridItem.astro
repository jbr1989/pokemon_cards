---
import type { UserListCard } from "../../models/UserListCard";
import ListCardActions from "./ListCardActions.astro";
import { languages } from "../../constants/languages";
import { variants } from "../../constants/variants";
interface Props {
  listCard: UserListCard | null;
  listType: string;
}

const { listCard, listType } = Astro.props;
const language = languages.find(({ code }) => code === listCard?.lang);
const variant = variants.find(({ code }) => code === listCard?.variant);
---

<div class="cardItem cardItemEffect">
  <ListCardActions listCard={listCard} />

  <div>
    <a href={`/card/${listCard?.cardId}`}>
      <img
        class="cardItem-image"
        src={listCard?.image || "/img/card-not-found.jpg"}
        alt={listCard?.cardId || "Card not found"}
        title={listCard?.cardName || "Card not found"}
        loading="lazy"
        decoding="async"
        fetchpriority="low"
        sizes="(max-width: 640px) 150px, (max-width: 1024px) 200px, 250px"
        style="background-color: #1f2937;"
        data-lang={language?.lang}
        onerror={listCard?.image ? "changeImageLang(this)" : undefined}
      />

      <div
        class="capitalize grid grid-cols-2 gap-2 items-start px-1"
        style="grid-template-columns: 1fr 35px;"
      >
        <span>
          {listType == "pokedex" ? listCard?.dexId : listCard?.cardId} -
          {listCard?.pokemonName}
        </span>
        <span class="flex flex-nowrap gap-1" style="justify-content: flex-end;">
          {
            listCard?.variant != "" && (
              <img
                src={variant?.flag.dark}
                alt="Variant"
                loading="lazy"
                decoding="async"
                class="w-[1rem] h-[1rem] mt-1 inline"
                title={variant?.name}
              />
            )
          }
          {
            (listCard?.cardName != "" || listCard?.lang != "") && (
              <img
                src={language?.flag}
                alt="Language"
                loading="lazy"
                decoding="async"
                class="w-[1rem] h-[1rem] mt-1 inline"
                title={language?.name}
              />
            )
          }
        </span>
      </div>
    </a>
  </div>
</div>
